<script src='https://d3js.org/d3.v7.min.js'></script>
<script>
    let heartfailurecsv = 'https://raw.githubusercontent.com/akmand/datasets/master/heart_failure.csv';
    /*
    age,anaemia,creatinine_phosphokinase,diabetes,ejection_fraction,high_blood_pressure,platelets,serum_creatini
    ne,serum_sodium,sex,smoking,time,DEATH_EVENT
    75,0,582,0,20,1,265000,1.9,130,1,0,4,1
    55,0,7861,0,38,0,263358.03,1.1,136,1,0,6,1
    65,0,146,0,20,0,162000,1.3,129,1,1,7,1
    50,1,111,0,20,0,210000,1.9,137,1,0,7,1
    */


    d3.csv(heartfailurecsv).then(function (data) {

        let heart_failure_between_1_and_30 = 0;
        let heart_failure_between_31_and_40 = 0;
        let heart_failure_between_41_and_60 = 0;
        let heart_failure_between_61_and_100 = 0;

        for (let i = 0; i < data.length; i++) {

            //Count titles
            if (data[i].DEATH_EVENT == 1) {
                if (data[i].age <= 30) {
                    heart_failure_between_1_and_30++;
                } else if (data[i].age >= 31 && data[i].age <= 40) {
                    heart_failure_between_31_and_40++;
                } else if (data[i].age >= 41 && data[i].age <= 60) {
                    heart_failure_between_41_and_60++;
                } else if (data[i].age >= 61 && data[i].age <= 100) {
                    heart_failure_between_61_and_100++;
                }
            }

        }


        console.log("heart_failure_between_1_and_30: " + heart_failure_between_1_and_30);
        console.log("heart_failure_between_31_and_40: " + heart_failure_between_31_and_40);
        console.log("heart_failure_between_41_and_60: " + heart_failure_between_41_and_60);
        console.log("heart_failure_between_61_and_100: " + heart_failure_between_61_and_100);

        //create array
        let heart_failure_age_array = [heart_failure_between_1_and_30,
            heart_failure_between_31_and_40,
            heart_failure_between_41_and_60,
            heart_failure_between_61_and_100]
        console.log(heart_failure_age_array);

        d3.select("body")
            .selectAll("p")
            .data(heart_failure_age_array)
            .enter()
            .append("p")
            .text(function (d, i) {
                return d;
            })

    });

</script>